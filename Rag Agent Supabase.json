{
  "name": "Rag Agent",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        96,
        64
      ],
      "id": "4dfe488c-d1f9-42de-8b4a-2f6ce24f533b",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {
          "queryName": "match_documents"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        864,
        64
      ],
      "id": "581463a5-22f5-4aa3-a643-fe1c8612e738",
      "name": "Supabase Vector Store",
      "credentials": {
        "supabaseApi": {
          "id": "tn2JcmHOwUJdyVtn",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "dataType": "binary",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        912,
        240
      ],
      "id": "da0f9370-23fc-4f95-9f46-ba5f10329808",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "modelName": "models/gemini-embedding-exp-03-07"
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
      "typeVersion": 1,
      "position": [
        688,
        -32
      ],
      "id": "f27908e1-4c12-4ff3-b4d9-074001c36a0d",
      "name": "Embeddings Google Gemini",
      "credentials": {
        "googlePalmApi": {
          "id": "HfBBdaI7dRU73e4o",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "1RWB9UIDKyRMOOO0lot-br038bi2deG4k",
          "mode": "list",
          "cachedResultName": "financial aid form.docx",
          "cachedResultUrl": "https://docs.google.com/document/d/1RWB9UIDKyRMOOO0lot-br038bi2deG4k/edit?usp=drivesdk&ouid=107729290105715356585&rtpof=true&sd=true"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        384,
        64
      ],
      "id": "e4f1f5f6-0f3d-4b90-8501-108ae6f61c12",
      "name": "Download file",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "WtG413ZPhyuUfXlR",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        0,
        -336
      ],
      "id": "dd69c495-ac59-4b7b-9565-d575e9257554",
      "name": "When chat message received",
      "webhookId": "b6931424-81dc-429f-919f-44439b32c9d6"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        304,
        -336
      ],
      "id": "0e5cd1de-1dd3-46ea-95cb-af1e9da012dc",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        240,
        -112
      ],
      "id": "fb59fea2-839f-4e15-ab59-2de1851fab45",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "HfBBdaI7dRU73e4o",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Received answers for the query from the chat input",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "topK": 2,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        688,
        -224
      ],
      "id": "eabd0a42-dc22-4c5a-a860-ae6c65a366af",
      "name": "Supabase Vector Store1",
      "credentials": {
        "supabaseApi": {
          "id": "tn2JcmHOwUJdyVtn",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        368,
        -112
      ],
      "id": "80a48751-2f60-4a8c-919f-fc8ac9afbd50",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "725EbVE5vF7IKPd5",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "content": "This n8n workflow integrates Google Gemini with Supabase and PostgreSQL to create an AI-powered chat system. When a chat message is received, the AI Agent uses the Gemini Chat Model with stored memory from PostgreSQL and retrieves contextual embeddings from the Supabase Vector Store. Additionally, documents can be uploaded via Google Drive, embedded using Gemini, and stored in Supabase for enhanced AI responses.\n\n\n",
        "height": 224,
        "width": 464,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -544,
        -160
      ],
      "typeVersion": 1,
      "id": "e91ca39c-da75-449f-ab5c-ad3a1c233fb3",
      "name": "Sticky Note"
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Download file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Google Gemini": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_embedding",
            "index": 0
          },
          {
            "node": "Supabase Vector Store1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Download file": {
      "main": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Supabase Vector Store1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "0c9731d5-d150-406f-b3ef-429903ed1be6",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "6d1ede39f62ba94de09fa4d3d8da25e69031bfaf22d21a9f7427067f409c04a2"
  },
  "id": "IP2IbYXsJDHv6W8S",
  "tags": []
}